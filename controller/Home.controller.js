sap.ui.define(["sap/ui/core/mvc/Controller","../model/formatter","sap/ui/core/Fragment"],function(e,t,o){"use strict";return e.extend("ui5.demo.camera.controller.App",{formatter:t,onInit(){const e=this;const t=e.getOwnerComponent().getModel("config");const o=t.getProperty("/videoContraints");navigator.mediaDevices.enumerateDevices().then(e=>e.filter(e=>e.kind==="videoinput")).then(e=>{console.log(e);t.setProperty("/videoDevices",e)}).then(()=>o.video.deviceId.exact=t.getProperty("/videoDevices")[1].deviceId).then(()=>e.onChangeStream())},onChangeStream(){const e=this;const t=e.getOwnerComponent().getModel("config").getProperty("/videoContraints");const o=document.getElementById("video-stream");console.log(t);navigator.mediaDevices.getUserMedia(t).then(e=>{o.srcObject=e;o.play()})},handleTakeScreenshot(){const e=document.getElementById("video-canvas");const t=document.getElementById("video-stream");e.width=t.videoWidth;e.height=t.videoHeight;e.getContext("2d").drawImage(t,0,0);this.getOwnerComponent().getModel("config").setProperty("/cameraSnapUrl",e.toDataURL("image/jpg"));this.onOpenPreview()},onOpenPreview(){const e=this.getView();if(!this.byId("preview")){o.load({id:e.getId(),name:"ui5.demo.camera.view.Preview",controller:this}).then(t=>{e.addDependent(t);t.open()})}else{this.byId("preview").open()}},onClosePreview(){this.byId("preview").close()},handleSetDeviceId(){const e=this.byId("cam-select").getSelectedKey();this.getOwnerComponent().getModel("config").setProperty("/videoContraints/video/deviceId/exact",e);this.onChangeStream()}})});